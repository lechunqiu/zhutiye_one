this.b5mshoppingassist||(this.b5mshoppingassist={}),function(a){var b=["jquery-highcharts","common","server"];a.define("adv",b,function(a,b,c){function d(){var c=null,d=null,f=null,g=e("yyyy-MM-dd");try{var h=a.parseJSON(b5tplugin.getBrowserPopUrl());if(h)for(var i=h.newsdialog.content,j=0;j<i.length;j++)"browser"==i[j].displayPosition&&i[j].effectiveDateStr==g&&("js"==i[j].type?f=i[j]:d=i[j])}catch(k){}if(f){var l=f.showWebsite.replace(/\s/g,"");l||(l=".*");var l=new RegExp(l),m=b.getCookie("_n_p_ts");if(m||(m=0),m=parseInt(m),l.test(document.location.href)&&m<parseInt(f.showNum)){c=f;var n=(new Date).setHours(0,0,0,0)+864e5;b.setCookie("_n_p_ts",m+1,new Date(n).toUTCString())}}if(!c&&d){var o="";try{o=b.getCache("b5m_popAdv_date")}catch(k){}var p=!0;try{p=b5tplugin.isEnoughActiveDayNum()}catch(k){p=!0}var g=new Date,q=""+g.getFullYear()+g.getMonth()+g.getDate();if(p&&(!o||o!=q)){c=d;try{b.setCache("b5m_popAdv_date",q)}catch(k){}}}return c}function e(a){var b=new Date,c={"M+":b.getMonth()+1,"d+":b.getDate(),"h+":b.getHours(),"m+":b.getMinutes(),"s+":b.getSeconds(),"q+":Math.floor((b.getMonth()+3)/3),S:b.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(b.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return a}var f={},g=0,h=function(b){function d(b,c){var d=b,e=c,g=parseInt(j.css("right")),h=parseInt(j.css("bottom"));a(document).bind("mousemove.adv",function(a){1==f.start&&(g-=a.screenX-d,h-=a.screenY-e,j.css({right:g+"px",bottom:h+"px"}),d=a.screenX,e=a.screenY)})}var e='<div id="b5m_popPanel_wrap"><div id="b5m_popPanel"><a class="b5m-close" href="javascript:void(0);"/><iframe frameborder="0" scrolling="no" allowtransparency="true" /></div></div>',h=null,i=document.createElement("link");i.rel="stylesheet",i.href=c.assets_base_url+"/css/default/b5m-plugin-adv.css",i.type="text/css",document.getElementsByTagName("head")[0].appendChild(i),h=a(e);var j=h.find("#b5m_popPanel");"image"==b.type?j.addClass("b5m-popPanel-image"):"text"==b.type?j.addClass("b5m-popPanel-text"):"js"==b.type&&j.addClass("b5m-popPanel-js"),"js"!=b.type&&j.css("background","url("+b.skinUrl+") no-repeat"),j.find("iframe")[0].src=b.sourceUrl,h.appendTo(a("body")),a("body").css("overflow","auto"),setTimeout(function(){h.show()},3e3),g=setTimeout(function(){h.animate({opacity:0},4e3,function(){a(this).remove()})},3e5),h.hover(function(){h.stop(),h.css("opacity","1"),hover=!0,clearTimeout(g)},function(){hover=!1,g=setTimeout(function(){h.animate({opacity:0},4e3,function(){a(this).remove()})},3e5)}),j.find(".b5m-close").bind("click",function(){h.css("display","none")}),j.bind("mousedown",function(b){return 2==b.button||3==b.button?(b.stopPropagation(),b.preventDefault(),!1):void(a(b.target).hasClass("b5m-close")||(f.start=1,d(b.screenX,b.screenY)))}).bind("mouseup",function(){f.start=0,a(document).unbind("mousemove.adv")}),a(document).bind("mouseup",function(){f.start=0,a(document).unbind("mousemove.adv")})},i={run:function(){var a=document.getElementById("b5tplugin");if(a&&!(a.version<"4.0.8")){var b=d();b&&h(b)}}};return i})}(this.b5mshoppingassist);